#include "Maze.h"
#include <iostream>
#include <fstream>

Maze::Maze() {

	maze = { {'x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x',' ','\x9C',' ', ' ',' ',' ',' ', ' ',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ','x','x','x','x','x','x',' ','\x9C',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','\x9C',' ','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ','x','x','x','x','x','x','x','\x9C','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ','x','x','x','x','x','x',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x',' ',' ',' ',' ',' ',' ',' ',' ',' ','\x9C',' ',' ',' ',' ',' ',' ',' ',' ',' ','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ',' ',' ',' ',' ',' ',' ','\x9C',' ','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x',' ','\x9C',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ',' ',' ',' ',' ',' ',' ',' ','\x9C',' ','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x',' ','\x9C',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','P'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','\x9C','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ',' ',' ','\x9C',' ','x','x',' ','x','x','x','x','x','x',' ','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x',' ','x','x','x','x','x','x','\x9C','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x',' ','\x9C',' ',' ',' ',' ','x','x','x','x','x','x',' ','x','x','x','x','x','x',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ','x','x','x','x','x','x',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','\x9C',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x',' ',' ',' ','\x9C',' ','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'},
		{'x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x','x'}};

	prizes = {new Prize(1,2), new Prize(2,17), new Prize(2,34), new Prize(4,17), new Prize(7,18), new Prize(10,32), new Prize(12,15), new Prize(13,33), new Prize(16,6),
		new Prize(18,25), new Prize(19,9), new Prize(20,20), new Prize(21,2), new Prize(22,24), new Prize(23,9)};

	allCollected = false;

}
Maze::~Maze() {
	delete &maze;
}

void Maze::PrintMaze(Player* p) {

	cout << "--------------------------------------------" << "\n";

	int x = 0;
	int y = 0;
	for (int i = 0; i < 1000; i++) {
		
		if (maze[y][x] == 'P' && (y != p->GetPosition()[0] || x != p->GetPosition()[1])) {
			maze[y][x] = ' ';
		}

		cout << maze[y][x];

		if (x == 39) {
			x = 0;
			y++;
			cout << "\n";
		}
		else { x++; }

	}

	cout << "\n        Health: " << p->GetHealth() << "\n" ;

}

void Maze::Update(Player* p) {

	int collectCount = 0;
	for (int i = 0; i < prizes.size(); i++) {

		if (p->GetPosition() == prizes[i]->GetPosition()) {
			prizes[i]->playerCollected();
		}

		if (!prizes[i]->isCollected()) {
			maze[prizes[i]->GetPosition()[0]][prizes[i]->GetPosition()[1]] = '\x9C';
		}
		else {
			maze[prizes[i]->GetPosition()[0]][prizes[i]->GetPosition()[1]] = ' ';
			collectCount++;
		}

	}

	if (collectCount == 15) { allCollected = true; }

	maze[p->GetPosition()[0]][p->GetPosition()[1]] = 'P';

}

char Maze::GetChar(int y, int x) {

	if (x > 39) { return 'f'; }
	else { return maze[y][x]; }

}
